---
layout: post
title: Issues using Spring 3.0.5 and org.springframework.security.ldap 3.0.3
date: '2010-11-23T14:10:00.000-08:00'
author: Mark Corkery
tags:
- Programming
- spring framework
- Spring LDAP
- spring security
modified_time: '2013-10-20T14:22:34.815-07:00'
blogger_id: tag:blogger.com,1999:blog-7218688161043116845.post-2501652402339348759
blogger_orig_url: http://markcorkery.blogspot.com/2010/11/issues-using-spring-305-and.html
---

During development on a recent application, I was using the tomcat plugin and the target mvn tomcat:run to quickly deploy and test my application which is very handy for quickly eyeballing the UI.<br/><br/>Time had come to deploy to a test instance, and when I did the application fell over with the following exception:<br/><a name='more'></a><br/>[sourcecode language="java" wraplines="true"]<br/>2010-11-23 21:55:35,605 [main] ERROR org.springframework.web.servlet.DispatcherServlet - Context initialization failed<br/>org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping#0': Initialization of bean failed; nested exception is java.lang.NoSuchFieldError: USER_DECLARED_METHODS<br/>	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:527)<br/>	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:456)<br/>	at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:291)<br/>	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)<br/>	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:288)<br/>	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:190)<br/>	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:574)<br/>	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:895)<br/>	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:425)<br/>	at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:442)<br/>	at org.springframework.web.servlet.FrameworkServlet.createWebApplicationContext(FrameworkServlet.java:458)<br/>	at org.springframework.web.servlet.FrameworkServlet.initWebApplicationContext(FrameworkServlet.java:339)<br/>	at org.springframework.web.servlet.FrameworkServlet.initServletBean(FrameworkServlet.java:306)<br/>	at org.springframework.web.servlet.HttpServletBean.init(HttpServletBean.java:127)<br/>	at javax.servlet.GenericServlet.init(GenericServlet.java:212)<br/>	at org.apache.catalina.core.StandardWrapper.loadServlet(StandardWrapper.java:1173)<br/>	at org.apache.catalina.core.StandardWrapper.load(StandardWrapper.java:993)<br/>	at org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:4350)<br/>	at org.apache.catalina.core.StandardContext.start(StandardContext.java:4659)<br/>	at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:791)<br/>	at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:771)<br/>	at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:546)<br/>	at org.apache.catalina.startup.HostConfig.deployWAR(HostConfig.java:905)<br/>	at org.apache.catalina.startup.HostConfig.deployWARs(HostConfig.java:740)<br/>	at org.apache.catalina.startup.HostConfig.deployApps(HostConfig.java:500)<br/>	at org.apache.catalina.startup.HostConfig.start(HostConfig.java:1277)<br/>	at org.apache.catalina.startup.HostConfig.lifecycleEvent(HostConfig.java:321)<br/>	at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)<br/>	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1053)<br/>	at org.apache.catalina.core.StandardHost.start(StandardHost.java:785)<br/>	at org.apache.catalina.core.ContainerBase.start(ContainerBase.java:1045)<br/>	at org.apache.catalina.core.StandardEngine.start(StandardEngine.java:445)<br/>	at org.apache.catalina.core.StandardService.start(StandardService.java:519)<br/>	at org.apache.catalina.core.StandardServer.start(StandardServer.java:710)<br/>	at org.apache.catalina.startup.Catalina.start(Catalina.java:581)<br/>	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)<br/>	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)<br/>	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)<br/>	at java.lang.reflect.Method.invoke(Method.java:597)<br/>	at org.apache.catalina.startup.Bootstrap.start(Bootstrap.java:289)<br/>	at org.apache.catalina.startup.Bootstrap.main(Bootstrap.java:414)<br/>Caused by: java.lang.NoSuchFieldError: USER_DECLARED_METHODS<br/>	at org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping.determineUrlsForHandlerMethods(DefaultAnnotationHandlerMapping.java:191)<br/>	at org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping.determineUrlsForHandler(DefaultAnnotationHandlerMapping.java:118)<br/>	at org.springframework.web.servlet.handler.AbstractDetectingUrlHandlerMapping.detectHandlers(AbstractDetectingUrlHandlerMapping.java:79)<br/>	at org.springframework.web.servlet.handler.AbstractDetectingUrlHandlerMapping.initApplicationContext(AbstractDetectingUrlHandlerMapping.java:58)<br/>	at org.springframework.context.support.ApplicationObjectSupport.initApplicationContext(ApplicationObjectSupport.java:119)<br/>	at org.springframework.web.context.support.WebApplicationObjectSupport.initApplicationContext(WebApplicationObjectSupport.java:72)<br/>	at org.springframework.context.support.ApplicationObjectSupport.setApplicationContext(ApplicationObjectSupport.java:73)<br/>	at org.springframework.context.support.ApplicationContextAwareProcessor.invokeAwareInterfaces(ApplicationContextAwareProcessor.java:106)<br/>	at org.springframework.context.support.ApplicationContextAwareProcessor.postProcessBeforeInitialization(ApplicationContextAwareProcessor.java:85)<br/>	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.applyBeanPostProcessorsBeforeInitialization(AbstractAutowireCapableBeanFactory.java:394)<br/>	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1405)<br/>	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:519)<br/>	... 40 more<br/>[/sourcecode]<br/><br/>A quick google didn't reveal any obvious solutions but picking between the lines, I discovered that the root of the problem was that the dependency I had to org.springframework.security.ldap was pulling in old version of various springframework libraries.<br/><br/>So, the solution was to change the following in my pom.xml from:<br/><br/>[sourcecode language="xml" wraplines="false"]<br/>    &lt;dependency&gt;<br/>            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;<br/>            &lt;artifactId&gt;org.springframework.security.ldap&lt;/artifactId&gt;<br/>            &lt;version&gt;3.0.3.RELEASE&lt;/version&gt;<br/>    &lt;/dependency&gt;<br/>[/sourcecode]<br/><br/>to<br/><br/>[sourcecode language="xml" wraplines="false"]<br/>    &lt;dependency&gt;<br/>            &lt;groupId&gt;org.springframework.security&lt;/groupId&gt;<br/>            &lt;artifactId&gt;org.springframework.security.ldap&lt;/artifactId&gt;<br/>            &lt;version&gt;3.0.3.RELEASE&lt;/version&gt;<br/>            &lt;exclusions&gt;<br/>            	&lt;exclusion&gt;<br/>            		&lt;artifactId&gt;org.springframework.beans&lt;/artifactId&gt;<br/>            		&lt;groupId&gt;org.springframework&lt;/groupId&gt;<br/>            	&lt;/exclusion&gt;<br/>            	&lt;exclusion&gt;<br/>            		&lt;artifactId&gt;org.springframework.context&lt;/artifactId&gt;<br/>            		&lt;groupId&gt;org.springframework&lt;/groupId&gt;<br/>            	&lt;/exclusion&gt;<br/>            	&lt;exclusion&gt;<br/>            		&lt;artifactId&gt;org.springframework.core&lt;/artifactId&gt;<br/>            		&lt;groupId&gt;org.springframework&lt;/groupId&gt;<br/>            	&lt;/exclusion&gt;<br/>            	&lt;exclusion&gt;<br/>            		&lt;artifactId&gt;org.springframework.ldap&lt;/artifactId&gt;<br/>            		&lt;groupId&gt;org.springframework.ldap&lt;/groupId&gt;<br/>            	&lt;/exclusion&gt;<br/>            	&lt;exclusion&gt;<br/>            		&lt;artifactId&gt;org.springframework.security.core&lt;/artifactId&gt;<br/>            		&lt;groupId&gt;org.springframework.security&lt;/groupId&gt;<br/>            	&lt;/exclusion&gt;<br/>            &lt;/exclusions&gt;<br/>    &lt;/dependency&gt;<br/>[/sourcecode]